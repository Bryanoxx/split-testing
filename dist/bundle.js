var SplitTesting=(()=>{var u=Object.defineProperty;var y=e=>u(e,"__esModule",{value:!0});var S=(e,t)=>{y(e);for(var n in t)u(e,n,{get:t[n],enumerable:!0})};var k={};S(k,{setExperiment:()=>V});function T(e,t){t&&console.log("SplitTesting.js -",e)}function c(e){return t=>{T(t,e)}}function d(e){console.warn("SplitTesting.js -",e)}function l(e){return new Error(`SplitTesting.js - ${e}`)}function g(e){if(typeof e=="function")return e;let t=Array.isArray(e)?[]:{};for(var n in e){let i=e[n],a={}.toString.call(i).slice(8,-1);a==="Array"||a==="Object"?t[n]=g(i):a==="Date"?t[n]=new Date(i.getTime()):t[n]=i}return t}function f(e){let t=e.some(a=>a.weight!==void 0),n=e.every(a=>a.weight!==void 0),i=e.reduce((a,r)=>{var o;return a+((o=r.weight)!=null?o:0)},0);return t&&!n?(d("Some items have a weight but not all of them, reset of all weight"),!1):n&&i!==1?(d("The total of all weight is not equal to 1, reset of all weight"),!1):!!t}function h(e){let t=1/e.length;return e.map(i=>(i.weight=t,i))}function p(e,t){let n=t!==void 0?x(t):Math.random();return e.find(a=>{if(n<a.weight)return a;n-=a.weight})}function x(e){return(e.split("").map(a=>a.charCodeAt(0)).reduce((a,r)=>a+r,0)*9301+49297)%233280/233280}function V(e){var r,o,m;let t={name:e.name,variants:g(e.variants),seed:e.seed,isDebugMode:(r=e.isDebugMode)!=null?r:!1,isResolvingSeedConflictAllowed:(o=e.isResolvingSeedConflictAllowed)!=null?o:!0,storage:(m=e.storage)!=null?m:window==null?void 0:window.localStorage};if(typeof t.name!="string"||t.name.length===0)throw l("The experiment name must be a non-empty string");if(!Array.isArray(t.variants)||t.variants.length===0)throw l("The variants must be an array of at least one element");if(!t.variants.every(s=>s.name!==void 0&&s.name.length>0))throw l("The variants must have a name");if((window==null?void 0:window.localStorage)==null&&e.storage==null)throw l("No storage available, please define a custom storage property");let i=c(t.isDebugMode);i("Running split testing with these options :"),i(t);let a=w(t);if(a===null){i("No variant picked in storage, picking it now");let s=v(t,i);return t.onFirstPicking!==void 0&&t.onFirstPicking(s),s}else{if(i(`Variant already picked, named ${a.name}`),w(t)===void 0)throw l(`The variant named ${a.name} is not valid (not found in the variants)`);return t.isResolvingSeedConflictAllowed&&t.seed!==void 0&&!b(t)?(d("Conflict between the old seed and the current seed, updating the variant for the current seed"),v(t,i)):a}}function w(e){let t=e.storage.getItem(`ST-${e.name}-variant-name`);if(t===null)return null;let n=e.variants.find(i=>i.name===t);return n!=null?n:null}function W({name:e,storage:t,seed:n},i,a){t.setItem(`ST-${e}-variant-name`,i.name),a(`New picked variant: ${i.name} ${n!==void 0?"(with seed)":""}`),n!==void 0?t.setItem(`ST-${e}-seed`,n):t.removeItem(`ST-${e}-seed`)}function v(e,t){let n=e.variants,i=e.seed,a=f(n),r=a?n:h(n);a||t("Making all weight equal so the variants have the same probability of being picked");let o=p(r,i);return W(e,o,t),o}function b({name:e,seed:t,storage:n}){return n.getItem(`ST-${e}-seed`)===t}return k;})();
//# sourceMappingURL=bundle.js.map
