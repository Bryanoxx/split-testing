var SplitTesting=(()=>{var m=Object.defineProperty;var y=e=>m(e,"__esModule",{value:!0});var S=(e,n)=>{y(e);for(var t in n)m(e,t,{get:n[t],enumerable:!0})};var k={};S(k,{setExperiment:()=>x});function T(e,n){n&&console.log("SplitTesting.js -",e)}function f(e){return n=>{T(n,e)}}function l(e){console.warn("SplitTesting.js -",e)}function d(e){return new Error(`SplitTesting.js - ${e}`)}function g(e){if(typeof e=="function")return e;let n=Array.isArray(e)?[]:{};for(var t in e){let r=e[t],a={}.toString.call(r).slice(8,-1);a==="Array"||a==="Object"?n[t]=g(r):a==="Date"?n[t]=new Date(r.getTime()):n[t]=r}return n}function c(e){let n=e.some(a=>a.weight!==void 0),t=e.every(a=>a.weight!==void 0),r=e.reduce((a,i)=>{var o;return a+((o=i.weight)!=null?o:0)},0);return n&&!t?(l("Some items have a weight but not all of them, reset of all weight"),!1):t&&r!==1?(l("The total of all weight is not equal to 1, reset of all weight"),!1):!!n}function h(e){let n=1/e.length;return e.map(r=>(r.weight=n,r))}function p(e,n){let t=n!==void 0?b(n):Math.random();return e.find(a=>{if(t<a.weight)return a;t-=a.weight})}function b(e){return(e.split("").map(a=>a.charCodeAt(0)).reduce((a,i)=>a+i,0)*9301+49297)%233280/233280}function x(e){var i,o,u;if(typeof e.name!="string"||e.name.length===0)throw d("The experiment name must be a non-empty string");if(!Array.isArray(e.variants)||e.variants.length===0)throw d("The variants must be an array of at least one element");if(!e.variants.every(s=>s.name!==void 0&&s.name.length>0))throw d("The variants must have a name");if(e.storage=(i=e.storage)!=null?i:globalThis.window!==void 0?globalThis.window.localStorage:void 0,e.storage===void 0)throw d("No storage available, please define a custom storage property");let t={name:e.name,variants:g(e.variants),seed:e.seed,isDebugMode:(o=e.isDebugMode)!=null?o:!1,isResolvingSeedConflictAllowed:(u=e.isResolvingSeedConflictAllowed)!=null?u:!0,storage:e.storage},r=f(t.isDebugMode);r("Running split testing with these options :"),r(t);let a=w(t);if(a===null){r("No variant picked in storage, picking it now");let s=v(t,r);return t.onFirstPicking!==void 0&&t.onFirstPicking(s),s}else{if(r(`Variant already picked, named ${a.name}`),w(t)===void 0)throw d(`The variant named ${a.name} is not valid (not found in the variants)`);return t.isResolvingSeedConflictAllowed&&t.seed!==void 0&&!W(t)?(l("Conflict between the old seed and the current seed, updating the variant for the current seed"),v(t,r)):a}}function w(e){let n=e.storage.getItem(`ST-${e.name}-variant-name`);if(n===null)return null;let t=e.variants.find(r=>r.name===n);return t!=null?t:null}function V({name:e,storage:n,seed:t},r,a){n.setItem(`ST-${e}-variant-name`,r.name),a(`New picked variant: ${r.name} ${t!==void 0?"(with seed)":""}`),t!==void 0?n.setItem(`ST-${e}-seed`,t):n.removeItem(`ST-${e}-seed`)}function v(e,n){let t=e.variants,r=e.seed,a=c(t),i=a?t:h(t);a||n("Making all weight equal so the variants have the same probability of being picked");let o=p(i,r);return V(e,o,n),o}function W({name:e,seed:n,storage:t}){return t.getItem(`ST-${e}-seed`)===n}return k;})();
//# sourceMappingURL=bundle.js.map
